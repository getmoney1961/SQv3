---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { categories, quotesByCategory } from '../../scripts/data-loader.js';
import { generateCategorySlug } from '../../scripts/utils.js';

// Generate paths for all categories
export async function getStaticPaths() {
  return categories.map(category => {
    const categorySlug = generateCategorySlug(category);
    return {
      params: { category: categorySlug },
      props: { 
        category,
        quotes: quotesByCategory[category]
      }
    };
  });
}

const { category, quotes } = Astro.props;
const quoteCount = quotes.length;

// Get unique authors for this category
const authors = [...new Set(quotes.map(q => q.author))];

// SEO
const title = `${quoteCount} Quotes from ${category} | Success Quotes`;
const description = `Explore ${quoteCount} inspirational quotes from ${category}. Featuring wisdom from ${authors.slice(0, 3).join(', ')} and more.`;

// Schema.org structured data
const schemaData = {
  "@context": "https://schema.org",
  "@type": "CollectionPage",
  "name": `${category} Quotes`,
  "description": description,
  "url": `https://www.successquotes.co/category/${generateCategorySlug(category)}`,
  "numberOfItems": quoteCount
};
---

<BaseLayout 
  title={title}
  description={description}
  schemaData={schemaData}
>
  <div class="quote-container">
    <!-- Category Header -->
    <div style="text-align: center; margin-bottom: 50px;">
      <h1 style="font-size: 3em; color: white; margin-bottom: 15px; font-family: 'Instrument Serif', serif;">
        {category}
      </h1>
      <p style="font-size: 1.2em; color: #888;">
        {quoteCount} Inspirational {quoteCount === 1 ? 'Quote' : 'Quotes'}
      </p>
    </div>
    
    <!-- Featured Authors -->
    <div style="margin-bottom: 40px; text-align: center;">
      <p style="color: #888; margin-bottom: 15px;">Featured Authors:</p>
      <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
        {authors.slice(0, 10).map(author => {
          const authorSlug = quotes.find(q => q.author === author)?.authorSlug;
          return (
            <a href={`/author/${authorSlug}`} class="quote-tag">
              {author}
            </a>
          );
        })}
      </div>
    </div>
    
    <!-- Quotes Grid -->
    <div style="display: grid; gap: 30px; margin-top: 40px;">
      {quotes.map(quote => (
        <article 
          style="padding: 30px; background: rgba(255, 255, 255, 0.05); border-radius: 12px; transition: all 0.3s; border: 1px solid transparent;"
          onmouseover="this.style.background='rgba(255, 255, 255, 0.08)'; this.style.borderColor='rgba(255, 255, 255, 0.1)';"
          onmouseout="this.style.background='rgba(255, 255, 255, 0.05)'; this.style.borderColor='transparent';"
        >
          <a 
            href={`/quote/${quote.authorSlug}/${quote.slug}`}
            style="text-decoration: none;"
          >
            <blockquote style="color: white; font-size: 1.3em; line-height: 1.6; font-family: 'Instrument Serif', serif; font-style: italic; margin-bottom: 20px;">
              "{quote.quote}"
            </blockquote>
            
            <p style="color: #888; margin-bottom: 15px;">
              â€” {quote.author}
            </p>
            
            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
              {quote.topic && (
                <a href={`/topic/${quote.topicSlug}`} class="quote-tag" style="font-size: 0.85em;">
                  {quote.topic}
                </a>
              )}
            </div>
          </a>
        </article>
      ))}
    </div>
    
    <!-- Navigation -->
    <div class="quote-actions" style="margin-top: 60px;">
      <a href="/quotes" class="btn btn-secondary">Browse All Categories</a>
      <a href="/random" class="btn btn-primary">Get Random Quote</a>
    </div>
  </div>
</BaseLayout>


