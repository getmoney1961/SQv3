---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { topics, quotesByTopic } from '../../scripts/data-loader.js';
import { generateTopicSlug } from '../../scripts/utils.js';

// Generate paths for all topics
export async function getStaticPaths() {
  return topics.map(topic => {
    const topicSlug = generateTopicSlug(topic);
    return {
      params: { topic: topicSlug },
      props: { 
        topic,
        quotes: quotesByTopic[topic]
      }
    };
  });
}

const { topic, quotes } = Astro.props;
const quoteCount = quotes.length;

// Get unique authors for this topic
const authors = [...new Set(quotes.map(q => q.author))];

// SEO
const title = `${quoteCount} Inspirational Quotes About ${topic} | Success Quotes`;
const description = `Discover ${quoteCount} powerful quotes about ${topic.toLowerCase()}. Read wisdom from ${authors.slice(0, 3).join(', ')} and more successful leaders on ${topic.toLowerCase()}.`;

// Schema.org structured data
const schemaData = {
  "@context": "https://schema.org",
  "@type": "CollectionPage",
  "name": `Quotes About ${topic}`,
  "description": description,
  "url": `https://www.successquotes.co/topic/${generateTopicSlug(topic)}`,
  "numberOfItems": quoteCount,
  "about": {
    "@type": "Thing",
    "name": topic
  }
};
---

<BaseLayout 
  title={title}
  description={description}
  schemaData={schemaData}
>
  <div class="quote-container">
    <!-- Topic Header -->
    <div style="text-align: center; margin-bottom: 50px;">
      <h1 style="font-size: 3em; color: white; margin-bottom: 15px; font-family: 'Instrument Serif', serif;">
        Quotes About {topic}
      </h1>
      <p style="font-size: 1.2em; color: #888;">
        {quoteCount} Inspirational {quoteCount === 1 ? 'Quote' : 'Quotes'}
      </p>
    </div>
    
    <!-- Featured Authors -->
    <div style="margin-bottom: 40px; text-align: center;">
      <p style="color: #888; margin-bottom: 15px;">Featured Authors:</p>
      <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
        {authors.slice(0, 10).map(author => {
          const authorSlug = quotes.find(q => q.author === author)?.authorSlug;
          return (
            <a href={`/author/${authorSlug}`} class="quote-tag">
              {author}
            </a>
          );
        })}
      </div>
    </div>
    
    <!-- Quotes Grid -->
    <div style="display: grid; gap: 30px; margin-top: 40px;">
      {quotes.map(quote => (
        <article 
          style="padding: 30px; background: rgba(255, 255, 255, 0.05); border-radius: 12px; transition: all 0.3s; border: 1px solid transparent;"
          onmouseover="this.style.background='rgba(255, 255, 255, 0.08)'; this.style.borderColor='rgba(255, 255, 255, 0.1)';"
          onmouseout="this.style.background='rgba(255, 255, 255, 0.05)'; this.style.borderColor='transparent';"
        >
          <a 
            href={`/quote/${quote.authorSlug}/${quote.slug}`}
            style="text-decoration: none;"
          >
            <blockquote style="color: white; font-size: 1.3em; line-height: 1.6; font-family: 'Instrument Serif', serif; font-style: italic; margin-bottom: 20px;">
              "{quote.quote}"
            </blockquote>
            
            <p style="color: #888; margin-bottom: 15px;">
              â€” {quote.author}
            </p>
            
            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
              {quote.category && (
                <span class="quote-tag" style="font-size: 0.85em;">
                  {quote.category}
                </span>
              )}
            </div>
          </a>
        </article>
      ))}
    </div>
    
    <!-- Navigation -->
    <div class="quote-actions" style="margin-top: 60px;">
      <a href="/quotes" class="btn btn-secondary">Browse All Topics</a>
      <a href="/random" class="btn btn-primary">Get Random Quote</a>
    </div>
    
    <!-- CTA -->
    <div style="text-align: center; margin-top: 60px; padding: 40px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 16px;">
      <h3 style="font-size: 1.8em; color: white; margin-bottom: 15px;">
        Want more quotes about {topic.toLowerCase()}?
      </h3>
      <p style="color: rgba(255, 255, 255, 0.9); margin-bottom: 25px;">
        Get daily inspiration on {topic.toLowerCase()} and other success topics
      </p>
      <a 
        href="https://apps.apple.com/gb/app/success-quotes/id6752120038?itscg=30200&itsct=apps_box_link&mttnsubad=6752120038"
        class="btn btn-primary"
        style="background: white; color: #667eea;"
      >
        Download Success Quotes App
      </a>
    </div>
  </div>
</BaseLayout>


